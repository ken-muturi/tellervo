NAME "Corina"
    SIZE 400 400
    STATUS ON
    SYMBOLSET "/var/www/webservice/mapserver/symbols/symbols.sym"
    EXTENT -180 -90 180 90
    UNITS METERS
    SHAPEPATH "/var/www/webservice/mapserver/mapdata"

    WEB
        IMAGEPATH "/var/www/phpmapserver/tmp"
        IMAGEURL "/mapserver/tmp/"
        METADATA
          "wfs_title"            "Cornell Tree Ring Laboratory Map Server"  ## REQUIRED
          "wfs_onlineresource"   "http://dendro.cornell.edu/cgi-bin/mapserv?"  ## Recommended
          "wfs_srs"               "EPSG:4326"  ## Recommended
          "ows_schemas_location" "http://ogc.dmsolutions.ca"  ## Optional
        END

    END

    PROJECTION
      "init=epsg:4326"
    END
    
    LAYER
    NAME "SiteExtent"

        METADATA
          "wfs_title"    "Site extents" ## REQUIRED
          "gml_featureid" "siteid" ## REQUIRED
          "gml_include_items" "all"  ## Optional (serves all attributes for layer)
          "wfs_abstract" "Extent of all sites you have access to in the Corina Dendro Database"
        END

        TYPE POLYGON
        CONNECTIONTYPE POSTGIS
        CONNECTION "%%CONNSTRING%%"
        STATUS ON
        DUMP TRUE
        DATA "extent from (select * from %%SITETEMPTABLE%%) as foo using unique siteid using SRID=4326"
        
        PROJECTION
              "init=epsg:4326"
        END

    END
    

    LAYER
    NAME "SiteCentroid"

        METADATA
          "wfs_title"    "Site centroids" ## REQUIRED
          "gml_featureid" "siteid" ## REQUIRED
          "gml_include_items" "all"  ## Optional (serves all attributes for layer)
          "wfs_abstract" "Central point of each site you have access to in the Corina Dendro Database"
        END

        TYPE POINT
        CONNECTIONTYPE POSTGIS
        CONNECTION "%%CONNSTRING%%"
        STATUS ON
        DUMP TRUE
        DATA "sitecentroid from (select centroid(%%SITETEMPTABLE%%.extent) as sitecentroid, siteid from %%SITETEMPTABLE%%) as foo using unique siteid using SRID=4326"
        
        PROJECTION
              "init=epsg:4326"
        END

    END

    LAYER
    NAME "MeasurementExtent"

        METADATA
          "wfs_title"    "Measurement extents" ## REQUIRED
          "gml_featureid" "vmeasurementid" ## REQUIRED
          "gml_include_items" "all"  ## Optional (serves all attributes for layer)
          "wfs_abstract" "Extent of all measurements you have access to in the Corina Database"
        END

        TYPE POLYGON
        CONNECTIONTYPE POSTGIS
        CONNECTION "%%CONNSTRING%%"
        STATUS ON
        DUMP TRUE
        DATA "vmextent from (select * from %%MEASUREMENTTEMPTABLE%%) as foo using unique vmeasurementid using SRID=4326"
        
        PROJECTION
              "init=epsg:4326"
        END

    END

END

